<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Ubuntu on 王离谱的小破站</title>
        <link>https://yearsuns-github-io.vercel.app/tags/ubuntu/</link>
        <description>Recent content in Ubuntu on 王离谱的小破站</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-CN</language>
        <copyright>王离谱</copyright>
        <lastBuildDate>Sun, 18 May 2025 14:59:56 +0800</lastBuildDate><atom:link href="https://yearsuns-github-io.vercel.app/tags/ubuntu/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Ubuntu服务器运维安全最佳实践</title>
        <link>https://yearsuns-github-io.vercel.app/p/ubuntu-server-operations-security-best-practices/</link>
        <pubDate>Sun, 18 May 2025 14:59:56 +0800</pubDate>
        
        <guid>https://yearsuns-github-io.vercel.app/p/ubuntu-server-operations-security-best-practices/</guid>
        <description>&lt;blockquote&gt;
&lt;p&gt;本文面向使用 Ubuntu Server 24 LTS 进行生产环境部署的团队。
目标是帮助你建立系统化、可执行、可审计的服务器安全策略，让入侵更难发生，让故障更容易排查。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;目录&#34;&gt;&lt;strong&gt;目录&lt;/strong&gt;
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;安全原则概述&lt;/li&gt;
&lt;li&gt;基础系统安全&lt;/li&gt;
&lt;li&gt;SSH 访问与账户安全&lt;/li&gt;
&lt;li&gt;网络访问控制（UFW / Fail2ban）&lt;/li&gt;
&lt;li&gt;服务与进程安全&lt;/li&gt;
&lt;li&gt;跳板机：运维安全的统一入口&lt;/li&gt;
&lt;li&gt;应用与数据安全&lt;/li&gt;
&lt;li&gt;日志监控与告警&lt;/li&gt;
&lt;li&gt;备份与恢复策略&lt;/li&gt;
&lt;li&gt;一页安全核对清单（Checklist）&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;一安全原则概述&#34;&gt;&lt;strong&gt;一、安全原则概述&lt;/strong&gt;
&lt;/h1&gt;&lt;p&gt;在开始具体操作前，需要先理解安全的三大原则：&lt;/p&gt;
&lt;h2 id=&#34;1-最小权限原则least-privilege&#34;&gt;&lt;strong&gt;1. 最小权限原则（Least Privilege）&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;用户与服务只应该拥有完成任务所需的最小权限。&lt;/p&gt;
&lt;h2 id=&#34;2-减少暴露面reduce-attack-surface&#34;&gt;&lt;strong&gt;2. 减少暴露面（Reduce Attack Surface）&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;关闭不需要的端口、服务和账户。攻击面越小，风险越小。&lt;/p&gt;
&lt;h2 id=&#34;3-全量审计traceability&#34;&gt;&lt;strong&gt;3. 全量审计（Traceability）&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;操作可回溯、日志可查询，才能在事故时快速定位问题。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;服务器安全不是堆命令，而是一个“最小暴露 + 可控访问 + 可追踪行为”的体系。&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;二基础系统安全&#34;&gt;&lt;strong&gt;二、基础系统安全&lt;/strong&gt;
&lt;/h1&gt;&lt;h2 id=&#34;1-保持系统更新最高优先级&#34;&gt;&lt;strong&gt;1. 保持系统更新（最高优先级）&lt;/strong&gt;
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt update
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt upgrade -y
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;开启自动安全更新：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt install unattended-upgrades
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo dpkg-reconfigure unattended-upgrades
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;2-禁用不必要的软件与服务&#34;&gt;&lt;strong&gt;2. 禁用不必要的软件与服务&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;列出已启用服务：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;systemctl list-unit-files --type&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;service
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;关闭：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo systemctl disable --now servicename
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;3-使用-lts-版本与官方软件仓库&#34;&gt;&lt;strong&gt;3. 使用 LTS 版本与官方软件仓库&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;避免第三方未知源：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo add-apt-repository --remove ppa:xxx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;第三方源越多，安全风险越大。&lt;/p&gt;
&lt;h1 id=&#34;三ssh-访问与账户安全&#34;&gt;&lt;strong&gt;三、SSH 访问与账户安全&lt;/strong&gt;
&lt;/h1&gt;&lt;h2 id=&#34;1-禁止-root-直接登录&#34;&gt;&lt;strong&gt;1. 禁止 root 直接登录&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;编辑 SSH 配置：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo nano /etc/ssh/sshd_config
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;设置：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;PermitRootLogin no
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;2-禁用密码登录强烈建议&#34;&gt;&lt;strong&gt;2. 禁用密码登录（强烈建议）&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;SSH 改为密钥认证：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;PasswordAuthentication no
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;生成密钥：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ssh-keygen -t ed25519
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;上传密钥：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ssh-copy-id user@server
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;3-管控服务器用户&#34;&gt;&lt;strong&gt;3. 管控服务器用户&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;查看所有用户：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cut -d: -f1 /etc/passwd
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;删除不再需要的用户：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo deluser username
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;4-sudo-权限最小化&#34;&gt;&lt;strong&gt;4. sudo 权限最小化&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;创建普通用户，再赋予 sudo 权限：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo usermod -aG sudo devuser
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;与此同时避免：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;sudo su -
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这样的 root 长时间工作模式。&lt;/p&gt;
&lt;h2 id=&#34;5-使用-ssh-登录速率限制&#34;&gt;&lt;strong&gt;5. 使用 SSH 登录速率限制&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;在 SSH 配置中加入：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;MaxAuthTries 3
MaxSessions 5
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&#34;四网络访问控制ufw--fail2ban&#34;&gt;&lt;strong&gt;四、网络访问控制（UFW / Fail2ban）&lt;/strong&gt;
&lt;/h1&gt;&lt;h2 id=&#34;1-启用-ufw-防火墙&#34;&gt;&lt;strong&gt;1. 启用 UFW 防火墙&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;启用防火墙：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo ufw enable
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;仅开放必要端口：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo ufw allow 22/tcp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo ufw allow 80/tcp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo ufw allow 443/tcp
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;默认拒绝其他端口：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo ufw default deny
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;查看状态：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo ufw status numbered
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;2-防暴力破解fail2ban&#34;&gt;&lt;strong&gt;2. 防暴力破解：Fail2ban&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;安装：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt install fail2ban
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;启用：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo systemctl enable --now fail2ban
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;查看封禁状态：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo fail2ban-client status
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Fail2ban 能阻止大量扫描和破解行为，是 SSH 最重要的保护措施之一。&lt;/p&gt;
&lt;h1 id=&#34;五服务与进程安全&#34;&gt;&lt;strong&gt;五、服务与进程安全&lt;/strong&gt;
&lt;/h1&gt;&lt;h2 id=&#34;1-不要让服务以-root-运行&#34;&gt;&lt;strong&gt;1. 不要让服务以 root 运行&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;为服务创建独立用户：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo adduser --system --no-create-home webuser
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;在 systemd 中配置：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;User=webuser
Group=webuser
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;2-限制服务权限文件与目录&#34;&gt;&lt;strong&gt;2. 限制服务权限（文件与目录）&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;例如 Web 目录：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;chmod -R &lt;span style=&#34;color:#ae81ff&#34;&gt;750&lt;/span&gt; /var/www/app
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;chown -R www-data:www-data /var/www/app
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;3-使用-apparmor-控制服务行为&#34;&gt;&lt;strong&gt;3. 使用 AppArmor 控制服务行为&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;查看 AppArmor 状态：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo aa-status
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;启用规则：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo aa-enforce /etc/apparmor.d/usr.sbin.nginx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;4-控制开放端口&#34;&gt;&lt;strong&gt;4. 控制开放端口&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;查看端口监听：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo ss -tulnp
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;关闭不必要端口能显著减少攻击面。&lt;/p&gt;
&lt;h1 id=&#34;六跳板机堡垒机运维安全的统一入口&#34;&gt;&lt;strong&gt;六、跳板机/堡垒机：运维安全的统一入口&lt;/strong&gt;
&lt;/h1&gt;&lt;p&gt;跳板机（Bastion Host / Jump Server）是企业安全体系中的标配。&lt;/p&gt;
&lt;p&gt;它的作用包括：&lt;/p&gt;
&lt;h3 id=&#34;1-统一入口减少暴露面&#34;&gt;&lt;strong&gt;1. 统一入口：减少暴露面&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;所有服务器 SSH 都关闭公网，只暴露跳板机。&lt;/p&gt;
&lt;h3 id=&#34;2-强身份认证&#34;&gt;&lt;strong&gt;2. 强身份认证&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;密钥登录&lt;/li&gt;
&lt;li&gt;MFA&lt;/li&gt;
&lt;li&gt;LDAP/AD 企业认证&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;3-权限精细化控制&#34;&gt;&lt;strong&gt;3. 权限精细化控制&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;谁能访问哪台机器，谁能执行哪些命令一目了然。&lt;/p&gt;
&lt;h3 id=&#34;4-全量审计与录像&#34;&gt;&lt;strong&gt;4. 全量审计与录像&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;每条命令&lt;/li&gt;
&lt;li&gt;敏感操作告警&lt;/li&gt;
&lt;li&gt;可回放运维全过程&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;5-推荐方案&#34;&gt;&lt;strong&gt;5. 推荐方案&lt;/strong&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;开源：&lt;strong&gt;Jumpserver&lt;/strong&gt;（功能最完善的开源堡垒机）&lt;/li&gt;
&lt;li&gt;云厂商自带堡垒机（省心，安全合规）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;跳板机不是可选项，而是：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;安全访问控制体系的核心组件，应在中大型团队中强制使用。&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;七应用与数据安全&#34;&gt;&lt;strong&gt;七、应用与数据安全&lt;/strong&gt;
&lt;/h1&gt;&lt;h2 id=&#34;1-数据库不要暴露公网端口&#34;&gt;&lt;strong&gt;1. 数据库不要暴露公网端口&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;例如 MySQL 只监听本地：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;bind-address = 127.0.0.1
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;2-使用-httpslets-encrypt&#34;&gt;&lt;strong&gt;2. 使用 HTTPS（Let’s Encrypt）&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;自动颁发证书：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt install certbot python3-certbot-nginx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo certbot --nginx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;3-严格控制配置与密钥&#34;&gt;&lt;strong&gt;3. 严格控制配置与密钥&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;密钥文件设置权限：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;chmod &lt;span style=&#34;color:#ae81ff&#34;&gt;600&lt;/span&gt; id_rsa
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;私密配置（如 .env）不应向其他用户开放。&lt;/p&gt;
&lt;h2 id=&#34;4-版本控制不要上传敏感文件&#34;&gt;&lt;strong&gt;4. 版本控制不要上传敏感文件&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;Git 忽略：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;.env
*.pem
*.key
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&#34;八日志监控与告警&#34;&gt;&lt;strong&gt;八、日志监控与告警&lt;/strong&gt;
&lt;/h1&gt;&lt;h2 id=&#34;1-查看系统日志systemd&#34;&gt;&lt;strong&gt;1. 查看系统日志（systemd）&lt;/strong&gt;
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;journalctl -xe
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;2-服务级日志&#34;&gt;&lt;strong&gt;2. 服务级日志&lt;/strong&gt;
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;journalctl -u nginx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;3-登录行为审计&#34;&gt;&lt;strong&gt;3. 登录行为审计&lt;/strong&gt;
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;last
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;lastb
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;4-建立实时告警系统&#34;&gt;&lt;strong&gt;4. 建立实时告警系统&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;选择其一：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Netdata&lt;/li&gt;
&lt;li&gt;Prometheus + Grafana&lt;/li&gt;
&lt;li&gt;Zabbix&lt;/li&gt;
&lt;li&gt;云监控告警&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;监控指标：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CPU 异常升高&lt;/li&gt;
&lt;li&gt;磁盘将满&lt;/li&gt;
&lt;li&gt;SSH 登录异常&lt;/li&gt;
&lt;li&gt;服务 down 后自动告警&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;九备份与恢复策略&#34;&gt;&lt;strong&gt;九、备份与恢复策略&lt;/strong&gt;
&lt;/h1&gt;&lt;p&gt;备份是安全的最后一道防线。&lt;/p&gt;
&lt;h2 id=&#34;1-采用-3-2-1-原则&#34;&gt;&lt;strong&gt;1. 采用 3-2-1 原则&lt;/strong&gt;
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;3 份数据&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;2 种不同介质&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;1 份异地备份&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;2-常用备份方案&#34;&gt;&lt;strong&gt;2. 常用备份方案&lt;/strong&gt;
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;rsync（简单高效）&lt;/li&gt;
&lt;li&gt;BorgBackup / Restic（加密备份）&lt;/li&gt;
&lt;li&gt;云盘快照（极高恢复速度）&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;3-定期演练恢复&#34;&gt;&lt;strong&gt;3. 定期演练恢复&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;没有演练的备份 = 假备份。&lt;/p&gt;
&lt;h1 id=&#34;十一页安全核对清单checklist&#34;&gt;&lt;strong&gt;十、一页安全核对清单（Checklist）&lt;/strong&gt;
&lt;/h1&gt;&lt;p&gt;你可以用它快速检查服务器是否合规。&lt;/p&gt;
&lt;h3 id=&#34;-系统已更新&#34;&gt;✔ 系统已更新
&lt;/h3&gt;&lt;h3 id=&#34;-禁用-root-登录&#34;&gt;✔ 禁用 root 登录
&lt;/h3&gt;&lt;h3 id=&#34;-ssh-密钥登录--mfa&#34;&gt;✔ SSH 密钥登录 + MFA
&lt;/h3&gt;&lt;h3 id=&#34;-ufw-防火墙启用&#34;&gt;✔ UFW 防火墙启用
&lt;/h3&gt;&lt;h3 id=&#34;-fail2ban-启动&#34;&gt;✔ Fail2ban 启动
&lt;/h3&gt;&lt;h3 id=&#34;-不必要服务已关闭&#34;&gt;✔ 不必要服务已关闭
&lt;/h3&gt;&lt;h3 id=&#34;-服务不以-root-运行&#34;&gt;✔ 服务不以 root 运行
&lt;/h3&gt;&lt;h3 id=&#34;-数据库未暴露公网&#34;&gt;✔ 数据库未暴露公网
&lt;/h3&gt;&lt;h3 id=&#34;-日志可追踪&#34;&gt;✔ 日志可追踪
&lt;/h3&gt;&lt;h3 id=&#34;-使用跳板机集中管理运维&#34;&gt;✔ 使用跳板机集中管理运维
&lt;/h3&gt;&lt;h3 id=&#34;-有自动备份与恢复演练&#34;&gt;✔ 有自动备份与恢复演练
&lt;/h3&gt;</description>
        </item>
        <item>
        <title>Ubuntu24服务器入门教程</title>
        <link>https://yearsuns-github-io.vercel.app/p/ubuntu-24-server-beginners-guide/</link>
        <pubDate>Fri, 25 Apr 2025 14:59:56 +0800</pubDate>
        
        <guid>https://yearsuns-github-io.vercel.app/p/ubuntu-24-server-beginners-guide/</guid>
        <description>&lt;h1 id=&#34;一为什么要选择-ubuntu-server&#34;&gt;一、为什么要选择 Ubuntu Server？
&lt;/h1&gt;&lt;p&gt;CentOS 8 停止维护后，许多团队逐渐转向 Ubuntu。原因很简单：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;更新稳定 + 周期明确&lt;/strong&gt;：Ubuntu LTS（长期支持版）提供 5 年官方支持。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;软件生态更丰富&lt;/strong&gt;：apt 软件仓库巨大，新软件更新快。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;社区文档完善&lt;/strong&gt;：遇到问题基本都能找到解决方案。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;云原生友好&lt;/strong&gt;：Docker、Kubernetes 等官方支持都以 Ubuntu 为优先平台。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如果你希望服务器省心、上手快，Ubuntu 是最佳选择之一。&lt;/p&gt;
&lt;h1 id=&#34;二ubuntu-的基本原理它是如何工作的&#34;&gt;二、Ubuntu 的基本原理：它是如何工作的？
&lt;/h1&gt;&lt;p&gt;理解 Linux 的运行原理，有助于你更好地排查问题。&lt;/p&gt;
&lt;h2 id=&#34;1-linux--内核--用户空间&#34;&gt;1. Linux = 内核 + 用户空间
&lt;/h2&gt;&lt;p&gt;一个 Linux 系统本质上由两部分组成：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;内核（Kernel）&lt;/strong&gt;：直接与硬件交互，负责调度、内存、文件系统、网络等。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;用户空间（User Space）&lt;/strong&gt;：各种应用程序、Shell、守护进程等。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ubuntu Server 提供用户空间环境，让你用命令行操作内核能力。&lt;/p&gt;
&lt;h2 id=&#34;2-文件系统结构fhs&#34;&gt;2. 文件系统结构（FHS）
&lt;/h2&gt;&lt;p&gt;Linux 文件系统采用“树状结构”，&lt;strong&gt;所有内容都从根目录 &lt;code&gt;/&lt;/code&gt; 开始&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;常见目录解释：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;目录&lt;/th&gt;
          &lt;th&gt;用途&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;/etc&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;系统配置文件&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;/var&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;日志、缓存、可变数据&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;/usr&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;系统级程序与库&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;/home&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;普通用户的家目录&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;/root&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;root 用户家目录&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;/tmp&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;临时文件&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;/opt&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;第三方软件（可选）&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;把它理解为一棵树，而不是 Windows 的 C: D: 驱动器。&lt;/p&gt;
&lt;h2 id=&#34;3-软件管理apt&#34;&gt;3. 软件管理：APT
&lt;/h2&gt;&lt;p&gt;Ubuntu 使用 &lt;strong&gt;APT（Advanced Package Tool）&lt;/strong&gt; 管理软件。&lt;/p&gt;
&lt;p&gt;特点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;自动解决依赖&lt;/li&gt;
&lt;li&gt;软件来源于官方仓库&lt;/li&gt;
&lt;li&gt;一行命令即可安装/更新&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;后面会有详细示例。&lt;/p&gt;
&lt;h2 id=&#34;4-服务管理systemd&#34;&gt;4. 服务管理：systemd
&lt;/h2&gt;&lt;p&gt;Ubuntu 24 使用 &lt;strong&gt;systemd&lt;/strong&gt; 作为服务管理系统：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;开机启动&lt;/li&gt;
&lt;li&gt;服务管理（start/stop/restart）&lt;/li&gt;
&lt;li&gt;日志系统（journalctl）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这类命令你会非常常用。&lt;/p&gt;
&lt;h1 id=&#34;三快速上手安装后必须做的初始化&#34;&gt;三、快速上手：安装后必须做的初始化
&lt;/h1&gt;&lt;p&gt;假设你已经安装好 Ubuntu Server 24.x，以下步骤是上线前必须做的。&lt;/p&gt;
&lt;h2 id=&#34;1-更新系统&#34;&gt;1. 更新系统
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt update
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt upgrade -y
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;2-创建新用户并加-sudo-权限&#34;&gt;2. 创建新用户并加 sudo 权限
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo adduser devuser
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo usermod -aG sudo devuser
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;尽量不要用 root 直接工作。&lt;/p&gt;
&lt;h2 id=&#34;3-配置-ssh可选禁止密码登录&#34;&gt;3. 配置 SSH（可选：禁止密码登录）
&lt;/h2&gt;&lt;p&gt;查看 SSH 配置文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo nano /etc/ssh/sshd_config
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;常见设置：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;PasswordAuthentication no
PermitRootLogin no
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;改完后重启 SSH：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo systemctl restart ssh
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;4-安装常用工具&#34;&gt;4. 安装常用工具
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt install -y vim git curl unzip htop net-tools
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;四入门必学ubuntu-常用命令&#34;&gt;四、入门必学：Ubuntu 常用命令
&lt;/h1&gt;&lt;p&gt;以下命令覆盖日常开发者 90% 的工作量。&lt;/p&gt;
&lt;h2 id=&#34;1-文件与目录&#34;&gt;1. 文件与目录
&lt;/h2&gt;&lt;h3 id=&#34;查看目录&#34;&gt;查看目录
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ls
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ls -l    &lt;span style=&#34;color:#75715e&#34;&gt;# 显示详细信息&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ls -a    &lt;span style=&#34;color:#75715e&#34;&gt;# 显示隐藏文件&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;切换目录&#34;&gt;切换目录
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cd /etc
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cd ~      &lt;span style=&#34;color:#75715e&#34;&gt;# 回到自己的 home 目录&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cd -      &lt;span style=&#34;color:#75715e&#34;&gt;# 回到上一次目录&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;创建--删除&#34;&gt;创建 / 删除
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mkdir logs
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;rm -rf logs
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;2-文件处理&#34;&gt;2. 文件处理
&lt;/h2&gt;&lt;h3 id=&#34;查看文件内容&#34;&gt;查看文件内容
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cat file.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;less file.txt   &lt;span style=&#34;color:#75715e&#34;&gt;# 支持翻页&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;head -n &lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt; file.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tail -f /var/log/syslog    &lt;span style=&#34;color:#75715e&#34;&gt;# 实时查看日志&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;3-编辑文件nanovim&#34;&gt;3. 编辑文件（nano/vim）
&lt;/h2&gt;&lt;p&gt;nano 简单直接：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;nano config.ini
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;vim 强大但需要学习：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vim config.ini
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;4-软件安装与管理apt&#34;&gt;4. 软件安装与管理（APT）
&lt;/h2&gt;&lt;h3 id=&#34;安装软件&#34;&gt;安装软件
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt install nginx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;删除软件&#34;&gt;删除软件
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt remove nginx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;搜索软件包&#34;&gt;搜索软件包
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;apt search redis
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;更新整个系统&#34;&gt;更新整个系统
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt update &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt upgrade
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;5-服务管理systemctl&#34;&gt;5. 服务管理（systemctl）
&lt;/h2&gt;&lt;p&gt;启动服务：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo systemctl start nginx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;重启：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo systemctl restart nginx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;查看状态：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo systemctl status nginx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;设置开机启动：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo systemctl enable nginx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;6-网络调试&#34;&gt;6. 网络调试
&lt;/h2&gt;&lt;p&gt;查看 IP：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ip a
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Ping：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ping baidu.com
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;端口监听：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo ss -tulnp
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;7-用户与权限&#34;&gt;7. 用户与权限
&lt;/h2&gt;&lt;p&gt;当前用户：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;whoami
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;文件权限：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;chmod &lt;span style=&#34;color:#ae81ff&#34;&gt;755&lt;/span&gt; app.sh
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;chown ubuntu:ubuntu app.sh
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;五理解-linux-的权限模型非常重要&#34;&gt;五、理解 Linux 的权限模型（非常重要）
&lt;/h1&gt;&lt;p&gt;Linux 权限由三部分组成：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-rwxr-xr--
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;含义如下：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;区域&lt;/th&gt;
          &lt;th&gt;说明&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;rwx&lt;/td&gt;
          &lt;td&gt;文件所有者 的权限&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;r-x&lt;/td&gt;
          &lt;td&gt;文件所属组 的权限&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;r&amp;ndash;&lt;/td&gt;
          &lt;td&gt;其他用户 的权限&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;字符含义：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;r = read（读）&lt;/li&gt;
&lt;li&gt;w = write（写）&lt;/li&gt;
&lt;li&gt;x = execute（执行）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;数字对应：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;7 = rwx&lt;/li&gt;
&lt;li&gt;6 = rw-&lt;/li&gt;
&lt;li&gt;5 = r-x&lt;/li&gt;
&lt;li&gt;4 = r&amp;ndash;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以 755 = &lt;code&gt;rwxr-xr-x&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;理解这个模型是管理服务器的关键。&lt;/p&gt;
&lt;h1 id=&#34;六系统监控与排查&#34;&gt;六、系统监控与排查
&lt;/h1&gt;&lt;h2 id=&#34;1-查看资源占用&#34;&gt;1. 查看资源占用
&lt;/h2&gt;&lt;p&gt;CPU 和内存：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;top
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;htop
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;磁盘：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;df -h
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;目录占用：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;du -sh *
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;2-查看系统日志&#34;&gt;2. 查看系统日志
&lt;/h2&gt;&lt;p&gt;systemd 日志：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;journalctl -xe
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;查看某个服务日志：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;journalctl -u nginx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
        </item>
        
    </channel>
</rss>
