<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="一、引言：密码是互联网世界的最后防线 在整个互联网安全体系中，密码是最常见但也最脆弱的那一环。 我们每天使用的几乎所有服务——邮箱、网银、社交平台、游戏、论坛——都依赖密码来识别用户身份。\n">
<meta name="keywords" content="IT, 密码安全, 密码传输, 密码存储, 中间人攻击"><title>用户密码应该如何安全传输与存储</title>

<link rel='canonical' href='https://yearsuns-github-io.vercel.app/p/how-passwords-should-be-safely-transmitted-and-stored/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="用户密码应该如何安全传输与存储">
<meta property='og:description' content="一、引言：密码是互联网世界的最后防线 在整个互联网安全体系中，密码是最常见但也最脆弱的那一环。 我们每天使用的几乎所有服务——邮箱、网银、社交平台、游戏、论坛——都依赖密码来识别用户身份。\n">
<meta property='og:url' content='https://yearsuns-github-io.vercel.app/p/how-passwords-should-be-safely-transmitted-and-stored/'>
<meta property='og:site_name' content='王离谱的小破站'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='IT' /><meta property='article:tag' content='密码安全' /><meta property='article:tag' content='密码传输' /><meta property='article:tag' content='密码存储' /><meta property='article:tag' content='中间人攻击' /><meta property='article:published_time' content='2025-06-29T14:59:56&#43;08:00'/><meta property='article:modified_time' content='2025-06-29T14:59:56&#43;08:00'/>
<meta name="twitter:title" content="用户密码应该如何安全传输与存储">
<meta name="twitter:description" content="一、引言：密码是互联网世界的最后防线 在整个互联网安全体系中，密码是最常见但也最脆弱的那一环。 我们每天使用的几乎所有服务——邮箱、网银、社交平台、游戏、论坛——都依赖密码来识别用户身份。\n">
    <link rel="shortcut icon" href="/logo.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/logo_hu_c653ae95ee0b69fd.png" width="300"
                            height="400" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">🔞</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">王离谱的小破站</a></h1>
            <h2 class="site-description">破破烂烂</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/yearsuns'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='mailto:yearsuns@yeah.net'
                        target="_blank"
                        title="Email"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-mail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z" /><path d="M3 7l9 6l9 -6" /></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-home"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l-2 0l9 -9l9 9l-2 0" /><path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" /><path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" /></svg>
                
                <span>主页</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档</span>
            </a>
        </li>
        
        
        <li >
            <a href='/categories/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-category"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4h6v6h-6z" /><path d="M14 4h6v6h-6z" /><path d="M4 14h6v6h-6z" /><path d="M17 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0" /></svg>
                
                <span>分类</span>
            </a>
        </li>
        
        
        <li >
            <a href='/tags/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-tag"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M3 6v5.172a2 2 0 0 0 .586 1.414l7.71 7.71a2.41 2.41 0 0 0 3.408 0l5.592 -5.592a2.41 2.41 0 0 0 0 -3.408l-7.71 -7.71a2 2 0 0 0 -1.414 -.586h-5.172a3 3 0 0 0 -3 3z" /></svg>
                
                <span>标签</span>
            </a>
        </li>
        
        
        <li >
            <a href='https://tools.yearsuns.com' target="_blank">
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-tool"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 10h3v-3l-3.5 -3.5a6 6 0 0 1 8 8l6 6a2 2 0 0 1 -3 3l-6 -6a6 6 0 0 1 -8 -8l3.5 3.5" /></svg>
                
                <span>工具</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-search"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg>
                
                <span>搜索</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-info-circle"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" /><path d="M12 9h.01" /><path d="M11 12h1v4h1" /></svg>
                
                <span>关于</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                    
                        <li id="i18n-switch">  
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                            <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                                
                                    <option value="https://yearsuns-github-io.vercel.app/" selected>中文</option>
                                
                                    <option value="https://yearsuns-github-io.vercel.app/en/" >English</option>
                                
                            </select>
                        </li>
                    
                

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>暗色模式</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#一引言密码是互联网世界的最后防线">一、引言：密码是互联网世界的最后防线</a></li>
    <li><a href="#二密码为什么如此危险">二、密码为什么如此危险？</a>
      <ul>
        <li><a href="#21-风险一传输途中泄露">2.1 风险一：传输途中泄露</a></li>
        <li><a href="#22-风险二服务器端泄露">2.2 风险二：服务器端泄露</a></li>
      </ul>
    </li>
    <li><a href="#三密码应该如何在网络中安全传输">三、密码应该如何在网络中安全传输？</a>
      <ul>
        <li><a href="#31-最朴素的方案https-直接发送密码">3.1 最朴素的方案：HTTPS 直接发送密码</a></li>
      </ul>
    </li>
    <li><a href="#四前端-hash可降低的风险与无法降低的风险">四、前端 hash：可降低的风险与无法降低的风险</a>
      <ul>
        <li><a href="#41-前端-hash-能防护什么">4.1 前端 hash 能防护什么？</a></li>
        <li><a href="#42-前端-hash-不能防护什么">4.2 前端 hash 不能防护什么？</a></li>
        <li><a href="#43-前端-hash-是否必要">4.3 前端 hash 是否必要？</a></li>
      </ul>
    </li>
    <li><a href="#五服务器端应该如何存储密码">五、服务器端应该如何存储密码？</a>
      <ul>
        <li><a href="#51-哈希算法从可逆变成不可逆">5.1 哈希算法：从可逆变成不可逆</a></li>
        <li><a href="#52-盐salt阻止彩虹表和批量破解">5.2 盐（Salt）：阻止彩虹表和批量破解</a></li>
        <li><a href="#53-慢哈希slow-hash真正提升攻击成本">5.3 慢哈希（Slow Hash）：真正提升攻击成本</a></li>
      </ul>
    </li>
    <li><a href="#六双层保护前端-hash--后端-slow-hash">六、双层保护：前端 hash + 后端 slow-hash</a></li>
    <li><a href="#七前端-hash-面临的重放攻击问题与解决方案">七、前端 hash 面临的“重放攻击”问题与解决方案</a>
      <ul>
        <li><a href="#71-完整流程">7.1 完整流程</a></li>
        <li><a href="#72-这样做的好处">7.2 这样做的好处</a></li>
        <li><a href="#73-常见工程问题">7.3 常见工程问题</a></li>
      </ul>
    </li>
    <li><a href="#八密码安全的若干补充实践常被忽略">八、密码安全的若干补充实践（常被忽略）</a>
      <ul>
        <li><a href="#81-永远不要通过邮件发送用户密码">8.1 永远不要通过邮件发送用户密码</a></li>
        <li><a href="#82-不要允许弱密码">8.2 不要允许弱密码</a></li>
        <li><a href="#83-多因素身份验证mfa--2fa">8.3 多因素身份验证（MFA / 2FA）</a></li>
        <li><a href="#84-账号保护机制">8.4 账号保护机制</a></li>
        <li><a href="#85-密码泄露检测hibp-api">8.5 密码泄露检测（HIBP API）</a></li>
      </ul>
    </li>
    <li><a href="#九现代密码体系的目标">九、现代密码体系的目标</a>
      <ul>
        <li><a href="#91-传输安全">9.1 传输安全</a></li>
        <li><a href="#92-存储安全">9.2 存储安全</a></li>
        <li><a href="#93-账号安全机制">9.3 账号安全机制</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/it/" >
                IT
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/how-passwords-should-be-safely-transmitted-and-stored/">用户密码应该如何安全传输与存储</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025年06月29日</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    阅读时长: 7 分钟
                </time>
            </div>
        
    </footer>
    

    
        <footer class="article-translations">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



            <div>
                
                    <a href="https://yearsuns-github-io.vercel.app/en/p/how-passwords-should-be-safely-transmitted-and-stored/" class="link">English</a>
                
            </div>
        </footer>
    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="一引言密码是互联网世界的最后防线">一、引言：密码是互联网世界的最后防线
</h2><p>在整个互联网安全体系中，密码是最常见但也最脆弱的那一环。
我们每天使用的几乎所有服务——邮箱、网银、社交平台、游戏、论坛——都依赖密码来识别用户身份。</p>
<p>密码本质上是一种“弱凭证”：</p>
<ul>
<li>它不能证明用户是谁，只能证明“知道某个秘密”</li>
<li>一旦这个秘密泄露，攻击者就能完全冒充你</li>
</ul>
<p>现代互联网攻击频繁且多样化，一次普通的密码泄露事件，往往会导致用户多个平台的账号一起“沦陷”。
要想守住这道防线，必须从<strong>传输阶段</strong>和<strong>存储阶段</strong>两方面同时发力。</p>
<p>本文将从基础概念出发，逐层深入，到最后构建出现代网站应采用的完整密码安全体系。</p>
<h2 id="二密码为什么如此危险">二、密码为什么如此危险？
</h2><p>初看起来，密码就是一些字符组成的字符串。
但密码泄露的危害远比想象严重，主要体现在两个方面。</p>
<h3 id="21-风险一传输途中泄露">2.1 风险一：传输途中泄露
</h3><p>从用户输入密码，到密码抵达服务器，中间会经过：</p>
<ul>
<li>浏览器</li>
<li>本地域名解析</li>
<li>操作系统网络栈</li>
<li>路由器</li>
<li>运营商网络</li>
<li>服务器负载均衡</li>
</ul>
<p>只要链路中任何一个环节被攻击，密码就可能被拦截。</p>
<p>理论上，HTTPS 已经解决了“被监听问题”。
但实际情况比理论复杂得多，常见风险包括：</p>
<ul>
<li>用户电脑被恶意软件植入假根证书（典型的中间人攻击手段）</li>
<li>公司/学校内网采用流量审计，自动解密 TLS</li>
<li>公共 Wi-Fi 通过 ARP 欺骗截获 HTTPS 并强制重新签发证书</li>
<li>浏览器插件注入恶意脚本读取用户输入</li>
<li>某些软件声称“优化网速”，实际插入监听模块</li>
<li>某些企业网关进行 SSL Inspection（合法但不安全）</li>
</ul>
<p>换句话说：</p>
<blockquote>
<p>你无法假设用户设备、网络环境永远是安全的。</p>
</blockquote>
<p>因此，传输阶段仍有提升空间。</p>
<h3 id="22-风险二服务器端泄露">2.2 风险二：服务器端泄露
</h3><p>更多泄露事件来自服务器端，常见场景包括：</p>
<ul>
<li>数据库被拖库（最常见）</li>
<li>日志中意外打印了用户密码</li>
<li>开发者临时调试时把密码输出到控制台</li>
<li>备份文件未加密，被误传到公共服务器</li>
<li>第三方监控系统抓取了敏感字段</li>
<li>代码漏洞（SQL 注入、RCE）导致数据库暴露</li>
<li>运维人员内部滥用权限</li>
</ul>
<p>如果服务器保存的是 <strong>明文密码</strong>，后果极其严重：</p>
<ul>
<li>所有用户密码全部泄露</li>
<li>用户在其他网站的账号也会被攻击（密码复用）</li>
<li>一旦攻击者能登录用户邮箱，后果会更加连锁扩大</li>
</ul>
<p>因此，服务器端必须确保“即使泄露，攻击者也不能从数据库中拿到真正密码”。</p>
<h2 id="三密码应该如何在网络中安全传输">三、密码应该如何在网络中安全传输？
</h2><h3 id="31-最朴素的方案https-直接发送密码">3.1 最朴素的方案：HTTPS 直接发送密码
</h3><p>这是目前几乎所有网站的默认做法：</p>
<pre tabindex="0"><code>浏览器 ——HTTPS——&gt; 服务器
</code></pre><p>优点：</p>
<ul>
<li>简单</li>
<li>成熟</li>
<li>性能高</li>
<li>兼容性好</li>
</ul>
<p>缺点是：
<strong>它把所有风险完全寄托在 TLS 的可靠性上。</strong></p>
<p>如果 TLS 被中间人攻击破坏，密码也会被明文劫持。</p>
<p>于是有人提出：是否应该 <strong>在浏览器端先对密码做一次 hash</strong>？</p>
<h2 id="四前端-hash可降低的风险与无法降低的风险">四、前端 hash：可降低的风险与无法降低的风险
</h2><p>前端 hash 的核心思想是：</p>
<blockquote>
<p>即便传输被监听，攻击者拿到的也不是明文密码。</p>
</blockquote>
<p>假设：</p>
<pre tabindex="0"><code>P  = 用户密码
H1 = hash(P)
</code></pre><p>浏览器发送 H1，而非 P。</p>
<h3 id="41-前端-hash-能防护什么">4.1 前端 hash 能防护什么？
</h3><ul>
<li>避免 MITM 直接获得用户真实密码</li>
<li>服务器日志、监控系统误输出时不会泄露明文密码</li>
<li>攻击者得到 H1 也无法用它登录用户在<strong>其他网站</strong>的账号</li>
<li>即使用户复用密码，也不会因为你的网站泄露而波及其他网站（很重要）</li>
<li>服务器可以完全不接触明文密码（零知识认证的一种初级形态）</li>
</ul>
<p>前端 hash 的意义在于：</p>
<blockquote>
<p>“就算你的网站被攻破，也不能泄露用户在其他网站的密码。”</p>
</blockquote>
<p>这是传统方案做不到的。</p>
<h3 id="42-前端-hash-不能防护什么">4.2 前端 hash 不能防护什么？
</h3><ul>
<li>攻击者可以直接使用 H1 登录你的网站（因为你把它当成凭证）</li>
<li>用户电脑中毒、键盘监听仍能拿到 P</li>
<li>不带 challenge 的 hash 会被重放攻击利用</li>
<li>不能替代 HTTPS（hash 后的结果也需要加密）</li>
</ul>
<p>换句话说：</p>
<blockquote>
<p>前端 hash 能减少损失，但不能消灭风险。</p>
</blockquote>
<h3 id="43-前端-hash-是否必要">4.3 前端 hash 是否必要？
</h3><p>实践中，它属于 <strong>可选但增益明确</strong> 的安全措施。</p>
<p>如果实现得当（通过 challenge 防重放），前端 hash 可以构成双重防线：</p>
<ol>
<li>TLS 层：传输安全</li>
<li>hash 层：降低密码复用的连带风险</li>
</ol>
<p>对于安全要求较高的系统（银行、企业级服务、开发者平台），常会采用这种方式。</p>
<h2 id="五服务器端应该如何存储密码">五、服务器端应该如何存储密码？
</h2><p>接下来进入密码安全的核心：
<strong>密码永不以明文形式出现，即便在服务器内部。</strong></p>
<p>行业标准包含三个关键词：</p>
<ol>
<li>hash</li>
<li>salt</li>
<li>slow hash（慢哈希）</li>
</ol>
<h3 id="51-哈希算法从可逆变成不可逆">5.1 哈希算法：从可逆变成不可逆
</h3><p>一个好的哈希函数应具备：</p>
<ul>
<li>碰撞概率极低</li>
<li>输入变化一位，输出完全不同（雪崩效应）</li>
<li>无法从输出反推输入</li>
</ul>
<p>服务器保存的不是密码，而是：</p>
<pre tabindex="0"><code>H = hash(P)
</code></pre><p>如果数据库泄露，攻击者无法直接得到密码。</p>
<h3 id="52-盐salt阻止彩虹表和批量破解">5.2 盐（Salt）：阻止彩虹表和批量破解
</h3><p>没有盐，所有用户的弱密码会产生相同的哈希。攻击者可以：</p>
<ul>
<li>用现成彩虹表匹配</li>
<li>批量推测密码（只需对每种常见密码算一次 hash）</li>
</ul>
<p>加入随机盐：</p>
<pre tabindex="0"><code>H = hash(P + salt)
</code></pre><p>每个用户的 salt 都不同，这意味着：</p>
<ul>
<li>两个“123456”的用户哈希也完全不同</li>
<li>彩虹表无效</li>
<li>攻击者必须针对每个用户分别尝试（成本剧增）</li>
</ul>
<p>salt 必须：</p>
<ul>
<li>足够长（16 字节以上）</li>
<li>随机（CSPRNG）</li>
<li>每个用户独立生成</li>
<li>不加密，明文存储在数据库中</li>
</ul>
<h3 id="53-慢哈希slow-hash真正提升攻击成本">5.3 慢哈希（Slow Hash）：真正提升攻击成本
</h3><p>SHA256 这类传统算法太快了。
现代 GPU 每秒可计算数十亿次 SHA256。</p>
<p>这意味着：</p>
<blockquote>
<p>如果使用 SHA256 直接存密码，即便加盐，攻击者仍然可以在短时间内撞库。</p>
</blockquote>
<p>因此必须使用专门为密码存储设计的慢哈希算法，例如：</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>算法</th>
          <th>特点</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>bcrypt</strong></td>
          <td>经典方案，可靠成熟</td>
      </tr>
      <tr>
          <td><strong>scrypt</strong></td>
          <td>抗 GPU，内存占用高</td>
      </tr>
      <tr>
          <td><strong>Argon2（推荐）</strong></td>
          <td>密码学大赛冠军，可调节 CPU、内存、并行度</td>
      </tr>
  </tbody>
</table></div>
<p>慢哈希的目标并不是“更安全的哈希”，而是：</p>
<blockquote>
<p>让每次计算都变得昂贵，使攻击者无法进行大规模暴力破解。</p>
</blockquote>
<p>工程实践中，登录速度影响不大，因为：</p>
<ul>
<li>用户登录次数相对少</li>
<li>每次 slow-hash 只需几十毫秒</li>
<li>攻击者无法用同样的速度尝试数十亿次密码</li>
</ul>
<h2 id="六双层保护前端-hash--后端-slow-hash">六、双层保护：前端 hash + 后端 slow-hash
</h2><p>综合前端与后端：</p>
<pre tabindex="0"><code>P → H1 = hash1(P) → （传输） → H2 = bcrypt(H1 + salt)
</code></pre><p>双层含义：</p>
<ol>
<li>即使 MITM 拿到 H1，也无法登录其他网站</li>
<li>即使数据库泄露拿到 H2，也很难反推 H1，更推不回 P</li>
<li>服务器永不接触明文密码，减少数据泄露面</li>
<li>日志、监控、报错信息都不会泄露 P</li>
</ol>
<p>这种“前端 hash + 后端慢哈希”的双层方案，在一些高安全要求的系统中被采用，用来降低密码泄露带来的连带风险。</p>
<h2 id="七前端-hash-面临的重放攻击问题与解决方案">七、前端 hash 面临的“重放攻击”问题与解决方案
</h2><p>如果前端 hash 写成：</p>
<pre tabindex="0"><code>H1 = hash(P)
</code></pre><p>攻击者截获 H1 → 可反复使用 H1 伪装用户登录。
这与“截获明文密码”几乎一样危险。</p>
<p>解决方案是加入 <strong>随机 challenge（挑战值）</strong>。</p>
<h3 id="71-完整流程">7.1 完整流程
</h3><ol>
<li>
<p><strong>用户访问登录页</strong>
服务器生成 challenge</p>
<pre tabindex="0"><code>challenge = 随机字符串
</code></pre></li>
<li>
<p><strong>浏览器收到 challenge 并计算</strong></p>
<pre tabindex="0"><code>H1 = hash(P + challenge)
</code></pre></li>
<li>
<p><strong>服务器验证</strong>
服务器用相同的规则验证：</p>
<pre tabindex="0"><code>bcrypt(H1 + salt) == stored_hash
</code></pre></li>
</ol>
<h3 id="72-这样做的好处">7.2 这样做的好处
</h3><ul>
<li>H1 每次不同（因为 challenge 不同）</li>
<li>攻击者截获 H1 不能重放</li>
<li>MITM 攻击的价值下降</li>
<li>不需要在后端存储 challenge，只需验证一次后丢弃即可</li>
</ul>
<h3 id="73-常见工程问题">7.3 常见工程问题
</h3><ul>
<li>challenge 需要避免被缓存（设置 no-cache 响应头）</li>
<li>challenge 不能太短（至少 16 字节以上）</li>
<li>前端必须使用安全的哈希函数（SHA256 或以上）</li>
<li>必须配合 HTTPS，否则 challenge 也会被劫持</li>
</ul>
<h2 id="八密码安全的若干补充实践常被忽略">八、密码安全的若干补充实践（常被忽略）
</h2><p>以下是许多工程团队常忽略但非常重要的细节。</p>
<h3 id="81-永远不要通过邮件发送用户密码">8.1 永远不要通过邮件发送用户密码
</h3><p>“重置密码并邮件发送新密码”这种做法极其危险。
正确方式是：</p>
<ul>
<li>邮件发送重置链接</li>
<li>链接带一次性 token</li>
<li>用户必须重新设置密码</li>
</ul>
<h3 id="82-不要允许弱密码">8.2 不要允许弱密码
</h3><p>弱密码的破解速度是指数级快的：</p>
<ul>
<li><code>123456</code></li>
<li><code>password</code></li>
<li><code>qwerty</code></li>
<li>用户手机号</li>
<li>用户生日</li>
</ul>
<p>应采用：</p>
<ul>
<li>黑名单词表（top 10k 最常见密码）</li>
<li>长度策略（≥12 字符）</li>
<li>强制使用密码管理器提示</li>
</ul>
<h3 id="83-多因素身份验证mfa--2fa">8.3 多因素身份验证（MFA / 2FA）
</h3><p>密码只是第一层。
加入第二层身份验证可以极大降低攻击成功率：</p>
<ul>
<li>TOTP（Google Authenticator）</li>
<li>短信验证码（弱，但仍有意义）</li>
<li>硬件密钥（FIDO2 / U2F）</li>
</ul>
<h3 id="84-账号保护机制">8.4 账号保护机制
</h3><ul>
<li>登录失败次数过多 → 暂时锁定</li>
<li>在可疑设备登录 → 发送提醒邮件</li>
<li>登录 IP/UA 异常 → 要求二次验证</li>
<li>支持用户查看“最近登录设备记录”</li>
</ul>
<h3 id="85-密码泄露检测hibp-api">8.5 密码泄露检测（HIBP API）
</h3><p>大型网站会在用户设置新密码时检查：</p>
<ul>
<li>该密码是否出现在大型泄露数据库中（如 HaveIBeenPwned）</li>
</ul>
<p>这能显著降低弱密码带来的风险。</p>
<h2 id="九现代密码体系的目标">九、现代密码体系的目标
</h2><p>通过本文的 step-by-step 介绍，我们可以建立一套现代密码工程的完整体系：</p>
<h3 id="91-传输安全">9.1 传输安全
</h3><ul>
<li>使用 HTTPS</li>
<li>必要时使用前端 hash 防止密码复用带来的连锁风险</li>
<li>使用 challenge 防止重放</li>
</ul>
<h3 id="92-存储安全">9.2 存储安全
</h3><ul>
<li>永不存储明文密码</li>
<li>每个用户使用独立 salt</li>
<li>使用 slow-hash</li>
</ul>
<h3 id="93-账号安全机制">9.3 账号安全机制
</h3><ul>
<li>强密码策略</li>
<li>MFA</li>
<li>登录异常检测</li>
<li>密码泄露比对</li>
<li>日志不记录敏感信息</li>
</ul>
<p>最终实现的目标只有一个：</p>
<blockquote>
<p>即便整个服务器被攻陷，攻击者仍然无法从系统中拿到任何用户的真实密码。</p>
</blockquote>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/it/">IT</a>
        
            <a href="/tags/%E5%AF%86%E7%A0%81%E5%AE%89%E5%85%A8/">密码安全</a>
        
            <a href="/tags/%E5%AF%86%E7%A0%81%E4%BC%A0%E8%BE%93/">密码传输</a>
        
            <a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8/">密码存储</a>
        
            <a href="/tags/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB/">中间人攻击</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
	const mainArticleElement = document.querySelector(".main-article");
        renderMathInElement(mainArticleElement, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">相关文章</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/how-to-build-a-personal-blog-with-hugo-and-github-pages/">
        
        

        <div class="article-details">
            <h2 class="article-title">使用 Hugo &#43; GitHub 搭建个人博客（自动部署）</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/protecting-sensitive-data-while-seeking-help/">
        
        

        <div class="article-details">
            <h2 class="article-title">如何向技术大佬请教问题且不泄露敏感信息</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/tips-for-explaining-tech-issues/">
        
        

        <div class="article-details">
            <h2 class="article-title">程序员的自救指南：如何精准描述你的技术问题，让大佬想帮你</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/best-practices-of-jwt/">
        
        

        <div class="article-details">
            <h2 class="article-title">JWT的最佳实践</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src="//cdn.jsdelivr.net/npm/twikoo@1.6.39/dist/twikoo.all.min.js"></script>
<div id="tcomment"></div>
<style>
    .twikoo {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
    :root[data-scheme="dark"] {
        --twikoo-body-text-color-main: rgba(255, 255, 255, 0.9);
        --twikoo-body-text-color: rgba(255, 255, 255, 0.7);
    }
    .twikoo .el-input-group__prepend,
    .twikoo .tk-action-icon,
    .twikoo .tk-submit-action-icon,
    .twikoo .tk-time,
    .twikoo .tk-comments-no,
    .twikoo .tk-comments-count {
        color: var(--twikoo-body-text-color);
    }
    .twikoo .el-input__inner,
    .twikoo .el-textarea__inner,
    .twikoo .tk-preview-container,
    .twikoo .tk-content,
    .twikoo .tk-nick,
    .twikoo .tk-send {
        color: var(--twikoo-body-text-color-main);
    }
    .twikoo .el-button{
        color: var(--twikoo-body-text-color)!important;
    }
    .twikoo .el-input__count {
        color: var(--twikoo-body-text-color) !important;
    }
    .OwO .OwO-body {
        background-color: var(--body-background) !important;
        color: var(--body-text-color) !important;
    }
</style><script>
    twikoo.init({
        envId: 'https:\/\/twikoo.yearsuns.com',
        el: '#tcomment',lang: 'zh-CN',})
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 王离谱
    </section>
    
    <section class="powerby">
        
            <a href="https://beian.miit.gov.cn/">粤ICP备2022043168号</a> <br/>
        使用 <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> 构建 <br />
        主题 <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> 由 <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> 设计
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
